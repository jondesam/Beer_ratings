{"ast":null,"code":"import _slicedToArray from \"/Users/jonhyun/Desktop/Dev/BeerMontreal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"/Users/jonhyun/Desktop/Dev/BeerMontreal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/jonhyun/Desktop/Dev/BeerMontreal/client/src/components/Beers.js\";\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  query BeersQuery {\\n    beers {\\n      abv\\n      available\\n      brewery\\n      ibu\\n      link\\n      name\\n      price\\n      ratings {\\n        name\\n        value\\n      }\\n      style\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState, useEffect } from 'react';\nimport gql from 'graphql-tag';\nimport { useQuery } from '@apollo/react-hooks';\nimport BeerItem from './BeerItem';\nimport InfiniteScroll from 'react-infinite-scroll-component';\nimport uniqBy from 'lodash.uniqby';\nimport chunk from 'lodash.chunk';\nvar BEERS_QUERY = gql(_templateObject());\nexport var Beers = function Beers() {\n  var _useQuery = useQuery(BEERS_QUERY),\n      loading = _useQuery.loading,\n      error = _useQuery.error,\n      data = _useQuery.data;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      allBeers = _useState2[0],\n      setAllBeers = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      beers = _useState4[0],\n      setBeers = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      beersChunk = _useState6[0],\n      setbeersChunk = _useState6[1];\n\n  var _useState7 = useState('UNTAPPD'),\n      _useState8 = _slicedToArray(_useState7, 2),\n      filteredBy = _useState8[0],\n      setFilter = _useState8[1];\n\n  var _useState9 = useState({\n    price: 0,\n    untappd: 0,\n    rateBeer: 0\n  }),\n      _useState10 = _slicedToArray(_useState9, 2),\n      avg = _useState10[0],\n      setAvg = _useState10[1];\n\n  var _useState11 = useState(true),\n      _useState12 = _slicedToArray(_useState11, 2),\n      hasMore = _useState12[0],\n      SetHasMore = _useState12[1]; //For AVG\n\n\n  useEffect(function () {\n    if (loading === false && data) {\n      setAllBeers(uniqBy(data.beers, 'name'));\n    }\n\n    switch (filteredBy) {\n      case 'PRICE':\n        allBeers.sort(sortByPrice);\n        break;\n\n      case 'UNTAPPD':\n        allBeers.sort(sortByUntappd);\n        break;\n\n      case 'RATE_BEER':\n        allBeers.filter(function (beer) {\n          return beer.ratings.value !== '0' && beer.ratings.value !== undefined;\n        });\n        allBeers.sort(sortByRatebeer);\n        break;\n\n      default:\n        break;\n    }\n  }, [loading, data]);\n  useEffect(function () {\n    setbeersChunk(chunk(uniqBy(allBeers, 'name'), 20));\n  }, [allBeers, filteredBy]);\n  useEffect(function () {\n    if (loading === false && data) {\n      setBeers(beersChunk[0]);\n    }\n  }, [loading, beersChunk, filteredBy]); // Calculate AVG\n\n  var len = allBeers.length;\n  var sumPrice = 0;\n  var sumRateBeer = 0;\n  var sumUntappd = 0;\n  var lenPrice = 0;\n  var lenUntapppd = 0;\n  var lenRateBeer = 0;\n\n  for (var i = 0; i < len; i++) {\n    if (allBeers[i].price && allBeers[i].price !== '0') {\n      sumPrice += parseFloat(allBeers[i].price);\n      lenPrice += 1;\n    }\n\n    if (allBeers[i].ratings[0] && allBeers[i].ratings[0].value !== '0') {\n      sumUntappd += parseFloat(allBeers[i].ratings[0].value);\n      lenUntapppd += 1;\n    }\n\n    if (allBeers[i].ratings[1] && allBeers[i].ratings[1].value !== '0') {\n      sumRateBeer += parseFloat(allBeers[i].ratings[1].value);\n      lenRateBeer += 1;\n    }\n  }\n\n  useEffect(function () {\n    if (sumUntappd !== 0 && sumPrice !== 0 && sumRateBeer !== 0) {\n      setAvg({\n        // ...avg,\n        price: (sumPrice / lenPrice).toFixed(2),\n        untappd: (sumUntappd / lenUntapppd).toFixed(2),\n        rateBeer: (sumRateBeer / lenRateBeer).toFixed(2)\n      });\n    }\n  }, [allBeers]);\n\n  var sortByPrice = function sortByPrice(a, b) {\n    var priceA = parseInt(a.price);\n    var priceB = parseInt(b.price);\n\n    if (priceA < priceB) {\n      return -1;\n    }\n\n    if (priceA > priceB) {\n      return 1;\n    }\n\n    return 0;\n  };\n\n  var sortByUntappd = function sortByUntappd(a, b) {\n    var ratingA = parseFloat(a.ratings[0].value);\n    var ratingB = parseFloat(b.ratings[0].value);\n    return ratingB - ratingA;\n  };\n\n  var sortByRatebeer = function sortByRatebeer(a, b) {\n    var ratingA = 0;\n    var ratingB = 0;\n\n    if (a.ratings[1] && b.ratings[1]) {\n      ratingA = parseFloat(a.ratings[1].value);\n      ratingB = parseFloat(b.ratings[1].value);\n    }\n\n    return ratingB - ratingA;\n  };\n\n  if (beers) {\n    switch (filteredBy) {\n      case 'PRICE':\n        beers.sort(sortByPrice);\n        break;\n\n      case 'UNTAPPD':\n        beers.sort(sortByUntappd);\n        break;\n\n      case 'RATE_BEER':\n        beers.sort(sortByRatebeer);\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  if (allBeers) {\n    switch (filteredBy) {\n      case 'PRICE':\n        allBeers.sort(sortByPrice);\n        break;\n\n      case 'UNTAPPD':\n        allBeers.sort(sortByUntappd);\n        break;\n\n      case 'RATE_BEER':\n        allBeers.sort(sortByRatebeer);\n        break;\n\n      default:\n        break;\n    }\n  } // Pagination\n\n\n  var pn = 1;\n\n  var fetchMoreData = function fetchMoreData() {\n    if (pn >= beersChunk.length) {\n      SetHasMore(false);\n    }\n\n    if (beersChunk[pn]) {\n      setBeers(beers.concat(beersChunk[pn]));\n    }\n  };\n\n  if (loading) return /*#__PURE__*/React.createElement(\"h4\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 23\n    }\n  }, \"Loading...\");\n  if (error) console.log(error);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cardy text-white  mb-3 sticky-top mt-3\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"nav\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    className: \"sitename display-4 filxed-top  ml-4 inline-block \",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 13\n    }\n  }, \"Canada's\", /*#__PURE__*/React.createElement(\"span\", {\n    className: \"title\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 23\n    }\n  }, \" Top Beers \"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"m-2 pb-2\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    className: \"form-inline mt-3 ml-4\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: filteredBy === 'UNTAPPD' ? 'btn btn-primary ' : 'btn btn-secondary',\n    type: \"button\",\n    onClick: function onClick() {\n      SetHasMore(true);\n      setFilter('UNTAPPD');\n      window.scrollTo(0, 0);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 15\n    }\n  }, \"By Untappd\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: filteredBy === 'RATE_BEER' ? 'btn btn-primary ml-1' : 'btn btn-secondary ml-1',\n    type: \"button\",\n    onClick: function onClick() {\n      SetHasMore(true);\n      setFilter('RATE_BEER');\n      window.scrollTo(0, 0);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 15\n    }\n  }, \"By Ratebeer\", ' ')), /*#__PURE__*/React.createElement(StarRatings, {\n    rating: avg.untappd,\n    starRatedColor: \"blue\" // changeRating={this.changeRating}\n    ,\n    numberOfStars: 5,\n    name: \"rating\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"avg sticky-top col-sm-4 mt-3 mb-3 ml-2\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    className: \"liner  \",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 15\n    }\n  }, \"Avg. Price : $ \", avg.price), /*#__PURE__*/React.createElement(\"h4\", {\n    className: \"liner \",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 15\n    }\n  }, \" Avg. Untappd : \", avg.untappd, \" / 5\"), /*#__PURE__*/React.createElement(\"h4\", {\n    className: \"liner  \",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 15\n    }\n  }, \" Avg. Ratebeer : \", avg.rateBeer, \" / 5\"))))), beers ? /*#__PURE__*/React.createElement(InfiniteScroll, {\n    dataLength: beers.length,\n    next: fetchMoreData,\n    hasMore: hasMore,\n    loader: /*#__PURE__*/React.createElement(\"h4\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 19\n      }\n    }, \"Loading...\"),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 9\n    }\n  }, beers.map(function (beer, index) {\n    pn = parseInt(Math.ceil(beers.length / 20));\n    return /*#__PURE__*/React.createElement(BeerItem, {\n      key: beer.name,\n      beer: beer,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 20\n      }\n    });\n  })) : null);\n};","map":{"version":3,"sources":["/Users/jonhyun/Desktop/Dev/BeerMontreal/client/src/components/Beers.js"],"names":["React","useState","useEffect","gql","useQuery","BeerItem","InfiniteScroll","uniqBy","chunk","BEERS_QUERY","Beers","loading","error","data","allBeers","setAllBeers","beers","setBeers","beersChunk","setbeersChunk","filteredBy","setFilter","price","untappd","rateBeer","avg","setAvg","hasMore","SetHasMore","sort","sortByPrice","sortByUntappd","filter","beer","ratings","value","undefined","sortByRatebeer","len","length","sumPrice","sumRateBeer","sumUntappd","lenPrice","lenUntapppd","lenRateBeer","i","parseFloat","toFixed","a","b","priceA","parseInt","priceB","ratingA","ratingB","pn","fetchMoreData","concat","console","log","window","scrollTo","map","index","Math","ceil","name"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport gql from 'graphql-tag'\nimport { useQuery } from '@apollo/react-hooks'\nimport BeerItem from './BeerItem'\nimport InfiniteScroll from 'react-infinite-scroll-component'\nimport uniqBy from 'lodash.uniqby'\nimport chunk from 'lodash.chunk'\n\nconst BEERS_QUERY = gql`\n  query BeersQuery {\n    beers {\n      abv\n      available\n      brewery\n      ibu\n      link\n      name\n      price\n      ratings {\n        name\n        value\n      }\n      style\n    }\n  }\n`\n\nexport const Beers = () => {\n  const { loading, error, data } = useQuery(BEERS_QUERY)\n\n  const [allBeers, setAllBeers] = useState([])\n  const [beers, setBeers] = useState([])\n  const [beersChunk, setbeersChunk] = useState([])\n  const [filteredBy, setFilter] = useState('UNTAPPD')\n  const [avg, setAvg] = useState({ price: 0, untappd: 0, rateBeer: 0 })\n\n  const [hasMore, SetHasMore] = useState(true)\n\n  //For AVG\n  useEffect(() => {\n    if (loading === false && data) {\n      setAllBeers(uniqBy(data.beers, 'name'))\n    }\n    switch (filteredBy) {\n      case 'PRICE':\n        allBeers.sort(sortByPrice)\n        break\n      case 'UNTAPPD':\n        allBeers.sort(sortByUntappd)\n        break\n      case 'RATE_BEER':\n        allBeers.filter(\n          (beer) =>\n            beer.ratings.value !== '0' && beer.ratings.value !== undefined\n        )\n        allBeers.sort(sortByRatebeer)\n        break\n      default:\n        break\n    }\n  }, [loading, data])\n\n  useEffect(() => {\n    setbeersChunk(chunk(uniqBy(allBeers, 'name'), 20))\n  }, [allBeers, filteredBy])\n\n  useEffect(() => {\n    if (loading === false && data) {\n      setBeers(beersChunk[0])\n    }\n  }, [loading, beersChunk, filteredBy])\n\n  // Calculate AVG\n  let len = allBeers.length\n\n  let sumPrice = 0\n  let sumRateBeer = 0\n  let sumUntappd = 0\n  let lenPrice = 0\n  let lenUntapppd = 0\n  let lenRateBeer = 0\n\n  for (var i = 0; i < len; i++) {\n    if (allBeers[i].price && allBeers[i].price !== '0') {\n      sumPrice += parseFloat(allBeers[i].price)\n      lenPrice += 1\n    }\n\n    if (allBeers[i].ratings[0] && allBeers[i].ratings[0].value !== '0') {\n      sumUntappd += parseFloat(allBeers[i].ratings[0].value)\n      lenUntapppd += 1\n    }\n    if (allBeers[i].ratings[1] && allBeers[i].ratings[1].value !== '0') {\n      sumRateBeer += parseFloat(allBeers[i].ratings[1].value)\n      lenRateBeer += 1\n    }\n  }\n\n  useEffect(() => {\n    if (sumUntappd !== 0 && sumPrice !== 0 && sumRateBeer !== 0) {\n      setAvg({\n        // ...avg,\n        price: (sumPrice / lenPrice).toFixed(2),\n        untappd: (sumUntappd / lenUntapppd).toFixed(2),\n        rateBeer: (sumRateBeer / lenRateBeer).toFixed(2),\n      })\n    }\n  }, [allBeers])\n\n  const sortByPrice = (a, b) => {\n    let priceA = parseInt(a.price)\n    let priceB = parseInt(b.price)\n\n    if (priceA < priceB) {\n      return -1\n    }\n    if (priceA > priceB) {\n      return 1\n    }\n    return 0\n  }\n\n  const sortByUntappd = (a, b) => {\n    let ratingA = parseFloat(a.ratings[0].value)\n    let ratingB = parseFloat(b.ratings[0].value)\n\n    return ratingB - ratingA\n  }\n\n  const sortByRatebeer = (a, b) => {\n    let ratingA = 0\n    let ratingB = 0\n    if (a.ratings[1] && b.ratings[1]) {\n      ratingA = parseFloat(a.ratings[1].value)\n      ratingB = parseFloat(b.ratings[1].value)\n    }\n\n    return ratingB - ratingA\n  }\n\n  if (beers) {\n    switch (filteredBy) {\n      case 'PRICE':\n        beers.sort(sortByPrice)\n        break\n      case 'UNTAPPD':\n        beers.sort(sortByUntappd)\n        break\n      case 'RATE_BEER':\n        beers.sort(sortByRatebeer)\n        break\n      default:\n        break\n    }\n  }\n\n  if (allBeers) {\n    switch (filteredBy) {\n      case 'PRICE':\n        allBeers.sort(sortByPrice)\n        break\n      case 'UNTAPPD':\n        allBeers.sort(sortByUntappd)\n        break\n      case 'RATE_BEER':\n        allBeers.sort(sortByRatebeer)\n        break\n      default:\n        break\n    }\n  }\n\n  // Pagination\n  let pn = 1\n  const fetchMoreData = () => {\n    if (pn >= beersChunk.length) {\n      SetHasMore(false)\n    }\n\n    if (beersChunk[pn]) {\n      setBeers(beers.concat(beersChunk[pn]))\n    }\n  }\n\n  if (loading) return <h4>Loading...</h4>\n  if (error) console.log(error)\n\n  return (\n    <div className='container'>\n      <div className='cardy text-white  mb-3 sticky-top mt-3'>\n        <div className='nav'>\n          <div>\n            <h1 className='sitename display-4 filxed-top  ml-4 inline-block '>\n              Canada's<span className='title'> Top Beers </span>\n            </h1>\n          </div>\n\n          <div className='m-2 pb-2'>\n            <form className='form-inline mt-3 ml-4'>\n              <button\n                className={\n                  filteredBy === 'UNTAPPD'\n                    ? 'btn btn-primary '\n                    : 'btn btn-secondary'\n                }\n                type='button'\n                onClick={() => {\n                  SetHasMore(true)\n\n                  setFilter('UNTAPPD')\n                  window.scrollTo(0, 0)\n                }}\n              >\n                By Untappd\n              </button>\n              <button\n                className={\n                  filteredBy === 'RATE_BEER'\n                    ? 'btn btn-primary ml-1'\n                    : 'btn btn-secondary ml-1'\n                }\n                type='button'\n                onClick={() => {\n                  SetHasMore(true)\n\n                  setFilter('RATE_BEER')\n                  window.scrollTo(0, 0)\n                }}\n              >\n                By Ratebeer{' '}\n              </button>\n            </form>\n            <StarRatings\n              rating={avg.untappd}\n              starRatedColor='blue'\n              // changeRating={this.changeRating}\n              numberOfStars={5}\n              name='rating'\n            ></StarRatings>\n            <div className='avg sticky-top col-sm-4 mt-3 mb-3 ml-2'>\n              <h4 className='liner  '>Avg. Price : $ {avg.price}</h4>\n              <h4 className='liner '> Avg. Untappd : {avg.untappd} / 5</h4>\n              <h4 className='liner  '> Avg. Ratebeer : {avg.rateBeer} / 5</h4>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {beers ? (\n        <InfiniteScroll\n          dataLength={beers.length}\n          next={fetchMoreData}\n          hasMore={hasMore}\n          loader={<h4>Loading...</h4>}\n        >\n          {beers.map((beer, index) => {\n            pn = parseInt(Math.ceil(beers.length / 20))\n\n            return <BeerItem key={beer.name} beer={beer} />\n          })}\n        </InfiniteScroll>\n      ) : null}\n    </div>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}